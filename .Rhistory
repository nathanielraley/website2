cars%>%count()
cars%>%count(cyl)
cars%>%count(cyl,am)
fit12<-lm(mpg~am*cyl,data=cars)
fit21<-lm(mpg~cyl*am,data=cars)
anova(fit12)
Anova(fit12,type=3)
anova(fit12)
anova(fit21)
cars%>%group_by(am)%>%summarize(sum((mpg-mean(mpg))^2))
cars%>%group_by(am)%>%mutate(mean=mean(mpg))%>%ungroup()%>%summarize(sum((mpg-mean)^2))
cars%>%mutate(grandmean=mean(mpg))%>%
group_by(am)%>%mutate(groupmean=mean(mpg))%>%
ungroup()%>%summarize(sum((groupmean-grandmean)^2))
cars%>%mutate(grandmean=mean(mpg))%>%
group_by(am)%>%mutate(groupmean=mean(mpg))%>%
ungroup()%>%summarize(SS_am=sum((groupmean-grandmean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%
ungroup()%>%summarize(SS_am=sum((am_mean-grand_mean)^2),SS_cyl=sum((cyl_mean-grand_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%
ungroup()%>%summarize(SS_am=sum((am_mean-grand_mean)^2),SS_cyl=sum((cyl_mean-grand_mean)^2),SS_T=sum((mpg-grand_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%
ungroup()%>%
summarize(SS_am=sum((am_mean-grand_mean)^2),
SS_cyl=sum((cyl_mean-grand_mean)^2),
SS_int=,sum((mpg-am_mean-cyl_mean+grand_mean)^2)
SS_T=sum((mpg-grand_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%
ungroup()%>%
summarize(SS_am=sum((am_mean-grand_mean)^2),
SS_cyl=sum((cyl_mean-grand_mean)^2),
SS_int=,sum((mpg-am_mean-cyl_mean+grand_mean)^2),
SS_T=sum((mpg-grand_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%
ungroup()%>%
summarize(SS_am=sum((am_mean-grand_mean)^2),
SS_cyl=sum((cyl_mean-grand_mean)^2),
SS_int=,sum((mpg-am_mean-cyl_mean+grand_mean)^2),
SS_T=sum((mpg-grand_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%
ungroup()%>%
summarize(SS_am=sum((am_mean-grand_mean)^2),
SS_cyl=sum((cyl_mean-grand_mean)^2),
SS_int=sum((mpg-am_mean-cyl_mean+grand_mean)^2),
SS_T=sum((mpg-grand_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am,cyl)%>%
mutate(cell_mean=mean(mpg))%>%
mutate(am_mean=mean(mpg))%>%
mutate(cyl_mean=mean(mpg))%>%
ungroup()%>%
summarize(SS_am=sum((am_mean-grand_mean)^2),
SS_cyl=sum((cyl_mean-grand_mean)^2),
SS_cells=sum((cell_mean-grand_mean)^2),
SS_interaction=SS_cells-SS_am-SS_cyl,
SS_T=sum((mpg-grand_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am,cyl)%>%mutate(cell_mean=mean(mpg))%>%ungroup()%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
summarize(SS_am=sum((am_mean-grand_mean)^2),
SS_cyl=sum((cyl_mean-grand_mean)^2),
SS_cells=sum((cell_mean-grand_mean)^2),
SS_interaction=SS_cells-SS_c
SS_T=sum((mpg-grand_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am,cyl)%>%mutate(cell_mean=mean(mpg))%>%ungroup()%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
summarize(SS_am=sum((am_mean-grand_mean)^2),
SS_cyl=sum((cyl_mean-grand_mean)^2),
SS_cells=sum((cell_mean-grand_mean)^2),
SS_interaction=SS_cells-SS_cyl-SS_am,
SS_T=sum((mpg-grand_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%
ungroup()%>%
summarize(SS_am=sum((am_mean-grand_mean)^2),
SS_cyl=sum((cyl_mean-grand_mean)^2),
SS_cells=sum((mpg-am_mean-cyl_mean+grand_mean)^2),
SS_T=sum((mpg-grand_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am,cyl)%>%mutate(cell_mean=mean(mpg))%>%ungroup()%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
summarize(SS_am=sum((am_mean-grand_mean)^2),
SS_cyl=sum((cyl_mean-grand_mean)^2),
SS_interaction=sum((cell_mean-cyl_mean-am_mean+grand_mean)^2),
SS_T=sum((mpg-grand_mean)^2))
824.7846-405.1506
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
summarize(SS_am=sum((am_mean-grand_mean)^2),
SS_cyl=sum((cyl_mean-grand_mean)^2),
SS_T=sum((mpg-grand_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am,cyl)%>%mutate(cell_mean=mean(mpg))%>%ungroup()%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
summarize(SS_am=sum((am_mean-grand_mean)^2),
SS_cyl=sum((cyl_mean-grand_mean)^2),
SS_T=sum((mpg-grand_mean)^2),
SS_E=sum((mpg-cell_mean)^2))
mod7<-lm(mpg~1,data=cars)
mod6<-lm(mpg~cyl,data=cars)
anova(mod6,mod7)
anova(mod7,mod6)
fit12<-lm(mpg~am*cyl,data=cars)
fit21<-lm(mpg~cyl*am,data=cars)
anova(fit12)
anova(fit21)
summary(aov(mpg~cyl,data=cars))
model2<-lm(mpg~cyl+am,data=cars)
anova(model6,model2)
anova(mod6,mod2)
mod2<-lm(mpg~cyl+am,data=cars)
anova(mod6,mod2)
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-cyl_mean)%>%
summarize(sum((cyl_res-am_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-grand_mean+(cyl_mean-grand_mean))%>%
summarize(sum((cyl_res-am_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-(grand_mean+(cyl_mean-grand_mean)))%>%
summarize(sum((cyl_res-am_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-(grand_mean+(cyl_mean-grand_mean)))%>%
summarize(sum((mean(cyl_res)-am_mean)^2))
anova(lm(mod2$residuals~cyl,data=cars))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-(grand_mean+(cyl_mean-grand_mean)))%>%
summarize(sum((mean(cyl_res)-am_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()
cars%>%select(mpg,cyl,am)%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-(grand_mean+(cyl_mean-grand_mean)))%>%
summarize(sum((mean(cyl_res)-am_mean)^2))
cars%>%select(mpg,cyl,am)%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-(grand_mean+(cyl_mean-grand_mean)))%>%
summarize(sum((mean(cyl_res)-am_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-(grand_mean+(cyl_mean-grand_mean)))%>%
mutate(grand_mean=mean(cyl_res))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
summarize(sum((am_mean-grand_mean)^2))
anova(lm(mod2$residuals~cyl,data=cars))
anova(lm(mod2$residuals~am,data=cars))
anova(lm(mod6$residuals~am,data=cars))
mod6$residuals
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-(grand_mean+(cyl_mean-grand_mean)))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
transmute(cyl_res=mpg-(grand_mean+(cyl_mean-grand_mean)))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
transmute(cyl_res=mpg-(grand_mean+(cyl_mean-grand_mean)))%>%
mutate(grand_mean=mean(cyl_res))%>%
group_by(am)%>%mutate(am_mean=mean(cyl_res))%>%ungroup()%>%
summarize(sum((am_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
transmute(cyl_res=mpg-(grand_mean+(cyl_mean-grand_mean)))%>%
mutate(grand_mean=mean(cyl_res))%>%
group_by(am)%>%mutate(am_mean=mean(cyl_res))%>%ungroup()%>%
summarize(sum((am_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-(grand_mean+(cyl_mean-grand_mean)))%>%
mutate(grand_mean=mean(cyl_res))%>%
group_by(am)%>%mutate(am_mean=mean(cyl_res))%>%ungroup()%>%
summarize(sum((am_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-cyl_mean))%>% #remove effect of
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(cyl_res=mpg-cyl_mean)%>% #remove effect of
mutate(grand_mean=mean(cyl_res))%>%
group_by(am)%>%mutate(am_mean=mean(cyl_res))%>%ungroup()%>%
summarize(sum((am_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(mpg_res=mpg-cyl_mean)%>% #remove effect of cylinders
mutate(grand_mean=mean(mpg_res))%>%
group_by(am)%>%mutate(am_mean=mean(mpg_res))%>%ungroup()%>%
summarize(sum((am_mean)^2))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(mpg_res=mpg-cyl_mean)%>% #remove effect of cylinders
mutate(grand_mean=mean(mpg_res))%>%
group_by(am)%>%mutate(am_mean=mean(mpg_res))%>%ungroup()%>%
summarize(sum((am_mean-grand_mean)^2))
anova(lm(mod6$residuals~am,data=cars))
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(mpg_res=mpg-am_mean)%>% #remove effect of transmission
mutate(grand_mean=mean(mpg_res))%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg_res))%>%ungroup()%>%
summarize(sum((cyl_mean-grand_mean)^2))
mod5<-lm(mpg~am,data=cars)
anova(mod7,mod5)
anova(mod2,mod5)
anova(mod5,mod2)
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(mpg_res=mpg-am_mean)%>% #remove effect of transmission
mutate(grand_mean=mean(mpg_res))%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg_res))%>%ungroup()%>%
summarize(sum((cyl_mean-grand_mean)^2))
anova(lm(mod5$residuals~cyl,data=cars))
anova(mod5,mod2)
cars%>%mutate(grand_mean=mean(mpg))%>%
group_by(am)%>%mutate(am_mean=mean(mpg))%>%ungroup()%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg))%>%ungroup()%>%
mutate(mpg_res=mpg-am_mean)%>% #remove effect of transmission
mutate(grand_mean=mean(mpg_res))%>%
group_by(cyl)%>%mutate(cyl_mean=mean(mpg_res))%>%ungroup()%>%
summarize(sum((cyl_mean)^2))
model.matrix(fit12)
model.matrix(fit12)
dmat<-model.matrix(fit12)
dmat[,1]%*%dmat[,2]
dmat[,1]%*%dmat[,3]
combn(6,2)
dmat[,combn(6,2)[1,]]%*%dmat[,combn(6,2)[2,]]
combn(6,2)[2,]
dmat[,1]%*%dmat[,3]
dmat<-model.matrix(fit)
dmat[,1]%*%dmat[,3]
dmat<-model.matrix(fit12)
dmat[,1]%*%dmat[,3]
anova(mod5,mod2)
mod12
fit12
anova(fit12)
mod1<-lm(mpg~am*cyl,data=cars)
anova(mod1,mod2)
anova(mod2,1)
mod1<-lm(mpg~am*cyl,data=cars)
anova(mod2,1)
anova(mod2,mod1)
Anova(mpg~am*cyl,data=cars,type=2)
Anova(mpg~am*cyl,type=2,data=cars)
Anova(fit12,type=2)
anova(mod2,mod5)
anova(mod5,mod2)
anova(mod6,mod2)
Anova(fit12,type=3)
anova(mod1,mod3)
mod3<-lm(mpg~am+am:cyl, data=cars)
mod4<-lm(mpg~cyl+am:cyl, data=cars)
anova(mod1,mod3)
anova(mod1,mod4)
mod1<-lm(mpg~am*cyl, data=cars)
anova(mod1,mod3)
anova(mod1,mod4)
anova(mod3,mod1)
anova(mod4,mod1)
mod1<-lm(mpg~am+cyl+am:cyl, data=cars)
mod3<-lm(mpg~am+am:cyl, data=cars)
anova(mod3,mod1)
anova(mod4,mod1)
anova(mod1, mod3)
mod1<-lm(mpg~am+cyl+am:cyl, data=cars)
mod3<-lm(mpg~am+am:cyl, data=cars)
mod4<-lm(mpg~cyl+am:cyl, data=cars)
anova(mod3,mod1)
anova(mod4,mod1)
model.matrix(gpigs)
model.matrix(fit)
model.matrix(fit)%>%colSums
model.matrix(fit)
modmat<-model.matrix(fit)
modmat[,2]%*%modmat[,3]
modmat
options(contrasts=c("contr.treatment","contr.treatment")
options(contrasts=c("contr.treatment","contr.treatment"))
options(contrasts=c("contr.treatment","contr.treatment"))
fit<-lm(len ~ supp + dose + supp:dose, data=gpigs) #or just len~supp*dose
Anova(fit)
modmat<-model.matrix(fit)
modmat
modmat[,2]%*%modmat[,3]
modmat
anova(mod5,mod2)
anova(mod6,mod2)
options(contrasts=c("contr.sum","contr.poly")) #this will only affect type III; I'll explain shortly
fit12<-lm(mpg~am*cyl,data=cars)
fit21<-lm(mpg~cyl*am,data=cars)
anova(mod1,mod3)
anova(mod1,mod4)
options(contrasts=c("contr.treatment","contr.treatment"))
mod1<-lm(mpg~am*cyl,data=cars)
mod3<-lm(mpg~am+am:cyl,data=cars)
mod4<-lm(mpg~cyl+am:cyl,data=cars)
anova(mod1,mod3)
anova(mod1,mod4)
options(contrasts=c("contr.sum","contr.treatment"))
mod1<-lm(mpg~am*cyl,data=cars)
mod3<-lm(mpg~am+am:cyl,data=cars)
mod4<-lm(mpg~cyl+am:cyl,data=cars)
anova(mod1,mod3)
anova(mod1,mod4)
options(contrasts=c("contr.treatment","contr.poly"))
mod1<-lm(mpg~am*cyl,data=cars)
mod3<-lm(mpg~am+am:cyl,data=cars)
mod4<-lm(mpg~cyl+am:cyl,data=cars)
anova(mod1,mod3)
anova(mod1,mod4)
Anova(lm(mpg~am*cyl,data=cars),type=3)
options(contrasts=c("contr.treatment","contr.treatment"))
Anova(lm(mpg~am*cyl,data=cars),type=3)
options(contrasts=c("contr.sum","contr.poly"))
Anova(lm(mpg~am*cyl,data=cars),type=3)
Anova(lm(mpg~am+cyl,data=cars),type=3)
options(contrasts=c("contr.treat","contr.treat"))
Anova(lm(mpg~am+cyl,data=cars),type=3)
options(contrasts=c("contr.treatment","contr.treatment"))
Anova(lm(mpg~am+cyl,data=cars),type=3)
mod<-lm(mpg~am+cyl,data=cars)
model.matrix(mod)
mod<-lm(mpg~am*cyl,data=cars)
model.matrix(mod)
options(contrasts=c("contr.sum","contr.poly"))
Anova(lm(mpg~am+cyl,data=cars),type=3)
Anova(lm(mpg~am*cyl,data=cars),type=3)
options(contrasts=c("contr.sum","contr.poly"))
Anova(lm(mpg~am*cyl,data=cars),type=3)
options(contrasts=c("contr.treatment","contr.treatment"))
Anova(lm(mpg~am*cyl,data=cars),type=3)
options(contrasts=c("contr.sum","contr.poly"))
Anova(lm(mpg~am*cyl,data=cars),type=3)
options(contrasts=c("contr.sum","contr.poly"))
model.matrix(lm(mpg~am*cyl,data=cars))
mod<-model.matrix(lm(mpg~am*cyl,data=cars))
mod[,2]%*%mod[,3]
options(contrasts=c("contr.treatment","contr.poly"))
mod<-model.matrix(lm(mpg~am*cyl,data=cars))
mod[,2]%*%mod[,3]
mod<-model.matrix(lm(mpg~am*cyl,data=cars))
mod[,2]%*%mod[,3]
Anova(lm(mpg~am*cyl,data=cars),type=3)
options(contrasts=c("contr.sum","contr.poly"))
model.matrix(lm(mpg~am*cyl,data=cars))
mod
mod<-t(mod)
mod<-t(mod) mod%*%mod
mod%*%mod
mod<-t(mod)
mod%*%mod
mod
mod[,2]%*%mod[,3]
options(contrasts=c("contr.sum","contr.poly"))
mod<-model.matrix(lm(mpg~am*cyl,data=cars))
mod<-t(mod)
mod[,2]%*%mod[,3]
mod<-model.matrix(lm(mpg~am*cyl,data=cars))
mod[,2]%*%mod[,3]
model.matrix(lm(mpg~am*cyl,data=cars))
unique(model.matrix(lm(mpg~am*cyl,data=cars)))
model.matrix(lm(mpg~am*cyl,data=cars))
model.matrix(lm(mpg~am*cyl,data=cars))$assign
unique(model.matrix(lm(mpg~am*cyl,data=cars)))
mod<-unique(model.matrix(lm(mpg~am*cyl,data=cars)))
mod[,2]%*%mod[,3]
options(contrasts=c("contr.treatment","contr.poly"))
mod<-unique(model.matrix(lm(mpg~am*cyl,data=cars)))
mod[,2]%*%mod[,3]
mod<-unique(cbind(cars$am,cars$cyl,model.matrix(lm(mpg~am*cyl,data=cars)))
head(mod)
mod<-unique(cbind(cars$am,cars$cyl,model.matrix(lm(mpg~am*cyl,data=cars))))
head(mod)
mod<-unique(cbind(am=cars$am,cyl=cars$cyl,model.matrix(lm(mpg~am*cyl,data=cars))))
head(mod)
mod<-model.matrix(lm(mpg~am*cyl,data=cars))
mod<-unique(cbind(am=cars$am,cyl=cars$cyl,mod))
head(mod)
arrange(mod,am)
mod<-unique(cbind(am=cars$am,cyl=cars$cyl,mod))
sort(mod,am)
mod
options(contrasts=c("contr.treatment","contr.poly"))
mod<-model.matrix(lm(mpg~am*cyl,data=cars))
mod<-unique(cbind(AM=cars$am,CYL=cars$cyl,mod))
mod[,2]%*%mod[,3]
mod
options(contrasts=c("contr.sum","contr.poly"))
mod<-model.matrix(lm(mpg~am*cyl,data=cars))
mod<-unique(cbind(AM=cars$am,CYL=cars$cyl,mod))
mod
options(contrasts=c("contr.sum","contr.poly"))
Anova(lm(mpg~am*cyl,data=cars),type=3)
options(contrasts=c("contr.treatment","contr.poly")) #These are the default contrasts in R
Anova(lm(mpg~am*cyl,data=cars),type=3)
mod<-model.matrix(lm(mpg~am*cyl,data=cars))
mod<-unique(cbind(AM=cars$am,CYL=cars$cyl,mod))
mod
mod[,3]%*%mod[,4]
options(contrasts=c("contr.sum","contr.poly"))
mod<-model.matrix(lm(mpg~am*cyl,data=cars))
mod<-unique(cbind(AM=cars$am,CYL=cars$cyl,mod))
mod
mod[,3]%*%mod[,4]
options(contrasts=c("contr.sum","contr.poly"))
mod<-model.matrix(lm(mpg~am*cyl,data=cars))
mod[,3]%*%mod[,4]
mod
biopsy
blogdown:::new_post_addin()
biopsy
str(biopsy)
?biopsy
biopsy%>%transmute(clump_thickness=V1,cell_uniformity=V2,outcome=class)
data<-biopsy%>%transmute(clump_thickness=V1,cell_uniformity=V2,outcome=class,y=as.numeric(outcome))
head(data)
data<-biopsy%>%transmute(clump_thickness=V1,cell_uniformity=V2,outcome=class,y=as.numeric(outcome)-1)
data
fit<-lm(y~clump_thickness+cell_uniformity,data=data)
summary(fit)
fit<-lm(y~clump_thickness,data=data)
summary(fit)
ggplot(data, aes(y,clump_thickness))+geom_point()+geom_smooth(method='lm')
ggplot(data, aes(clump_thickness,y))+geom_point()+geom_smooth(method='lm')
ggplot(data, aes(clump_thickness,y))+geom_point()+geom_smooth(method='glm')
ggplot(data, aes(clump_thickness,y))+geom_point()+geom_smooth()
ggplot(data, aes(clump_thickness,y))+geom_rug()+geom_smooth(method='lm')
head(biopsy)
ggplot(data, aes(clump_thickness,y))+geom_jitter()+geom_smooth(method='lm')
ggplot(data, aes(clump_thickness,y))+geom_jitter(width = .3)+geom_smooth(method='lm')
ggplot(data, aes(clump_thickness,y))+geom_jitter(.3,0)+geom_smooth(method='lm')
ggplot(data, aes(clump_thickness,y))+geom_jitter(width=.3,height=0)+geom_smooth(method='lm')
fit<-lm(qnorm(y)~clump_thickness,data=data)
fit<-lm(pnorm(y)~clump_thickness,data=data)
summary(fit)
pnorm(data$y)
fit<-glm(y~clump_thickness,data=data,link="probit")
fit<-glm(y~clump_thickness,data=data,family=binomial(link="probit"))
summary(fit)
fit<-lm(y~clump_thickness,data=data)
summary(fit)
predict(fit)
pnorm(predict(fit))
fit<-glm(y~clump_thickness,data=data,family=binomial(link="probit"))
summary(fit)
predict(fit)[1:5]
pnorm(predict(fit))[1:5]
fit<-lm(y~clump_thickness,data=data)
summary(fit)
pnorm(predict(fit))[1:5]
fit<-glm(y~clump_thickness,data=data,family=binomial(link="probit"))
summary(fit)
predict(fit)[1:5]
curve(pnorm(x,0,1),-4,4)
curve(qnorm(x,0,1),0,1)
fit<-lm(pnorm(y,0,1)~clump_thickness,data=data)
summary(fit)
fit<-glm(y~clump_thickness,data=data,family=binomial(link="probit"))
summary(fit)
fit<-lm(qnorm(y,0,1)~clump_thickness,data=data)
fit<-lm(y~clump_thickness,data=data)
fit<-lm(y~clump_thickness,data=data)
summary(fit)
pnorm(-.1895+.120947*1,0,1)
pnorm(-.1895+.120947*2,0,1)
pnorm(.120947)
17*24
14*24
